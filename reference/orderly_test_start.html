<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Prepare a directory for orderly to use — orderly_test_start • orderly</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Prepare a directory for orderly to use — orderly_test_start" />
<meta property="og:description" content="For interactive testing of orderly code.  This runs through and
sets everything up as orderly would (creates a new working
directory and copies files into it, pulls data from the database,
copies over any dependent reports) but then rather than running
the report hands back to the user. The orderly_data
function returns an environment with the extracted data." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">orderly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/orderly.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/changelog.html">orderly changelog</a>
    </li>
    <li>
      <a href="../articles/remote.html">orderly remotes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vimc/orderly">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare a directory for orderly to use</h1>
    <small class="dont-index">Source: <a href='https://github.com/vimc/orderly/blob/master/R/recipe_test.R'><code>R/recipe_test.R</code></a></small>
    <div class="hidden name"><code>orderly_test_start.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For interactive testing of orderly code.  This runs through and
sets everything up as orderly would (creates a new working
directory and copies files into it, pulls data from the database,
copies over any dependent reports) but then rather than running
the report hands back to the user. The <code>orderly_data</code>
function returns an environment with the extracted data.</p>
    </div>

    <pre class="usage"><span class='fu'>orderly_test_start</span>(
  <span class='no'>name</span>,
  <span class='kw'>parameters</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>envir</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span>(),
  <span class='kw'>root</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>locate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>instance</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>use_draft</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>remote</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)

<span class='fu'>orderly_test_check</span>(<span class='kw'>path</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>orderly_data</span>(
  <span class='no'>name</span>,
  <span class='kw'>parameters</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>envir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>root</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>locate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>instance</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>use_draft</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>name</th>
      <td><p>Name of the report to run (see
<code><a href='orderly_list.html'>orderly_list</a></code>).  A leading <code>src/</code> will be
removed if provided, allowing easier use of autocomplete.</p></td>
    </tr>
    <tr>
      <th>parameters</th>
      <td><p>Parameters passed to the report. A named list of
parameters declared in the <code>orderly.yml</code>.  Each parameter
must be a scalar character, numeric, integer or logical.</p></td>
    </tr>
    <tr>
      <th>envir</th>
      <td><p>The parent of the environment that will be used to
evaluate the report script; by default a new environment will be
made with the global environment as the parent.</p></td>
    </tr>
    <tr>
      <th>root</th>
      <td><p>The path to an orderly root directory, or <code>NULL</code>
(the default) to search for one from the current working
directory if <code>locate</code> is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>locate</th>
      <td><p>Logical, indicating if the configuration should be
searched for.  If <code>TRUE</code> and <code>config</code> is not given,
then orderly looks in the working directory and up through its
parents until it finds an <code>orderly_config.yml</code> file.</p></td>
    </tr>
    <tr>
      <th>instance</th>
      <td><p>Select instance of the source database to be used,
where multiple instances are configured.  Use a single
<em>unnamed</em> character string to indicate an instance to
match.  If given, then this name must be present in all
databases where instances are listed in
<code>orderly_config.yml</code>, and will be ignored by all database
where instances are not given.  See the "orderly" vignette for
further information.</p></td>
    </tr>
    <tr>
      <th>use_draft</th>
      <td><p>Should draft reports be used for dependencies?
This should be used only in development.  Valid values are
logical (<code>TRUE</code>, <code>FALSE</code>) or use the string
<code>newer</code> to use draft reports where they are newer than
archive reports.  For consistency, <code>always</code> and
<code>never</code> are equivalent to <code>TRUE</code> and <code>FALSE</code>,
respectively.</p></td>
    </tr>
    <tr>
      <th>remote</th>
      <td><p>Remote to use to resolve dependencies.  Use this in
order to run a report with the same dependencies as are
available on a remote server, particularly when using <code>id =
"latest"</code>.  Note that this is not the same as running
<code><a href='orderly_pull_dependencies.html'>orderly_pull_dependencies</a></code>, then <code>orderly_run</code>
with <code>remote = NULL</code>, as the pull/run approach will use the
latest report in <em>your</em> archive but the <code>remote =
"remote"</code> approach will use the latest approach in the
<em>remote</em> archive (which might be less recent).</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>Path to the report that is currently being run</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The path to the report directory</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Previous versions of orderly changed into the created directory
when using <code>orderly::orderly_test_start</code>, which allowed
interactive testing of a report, including ensuring that it has
created all expected outputs.  However, CRAN rules do not allow
changing the working directory, which significantly reduces the
usefulness of this function - as such we may remove it entirely in
a future version of orderly if it does not prove useful in this
more limited form.</p>
<p>The new suggested workflow is:</p>
<ol>
<li><p>run <code>orderly_test_start(...)</code> to prepare a report directory</p></li>
<li><p>manually change into that directory following the printed
  instructions</p></li>
<li><p>use <code>orderly_test_check</code> to check that your report has created
      the expected artefacts</p></li>
<li><p>manually change back to your original directory</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>path</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/orderly/man/orderly_example.html'>orderly_example</a></span>(<span class='st'>"minimal"</span>)
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/orderly/man/orderly_test_start.html'>orderly_test_start</a></span>(<span class='st'>"example"</span>, <span class='kw'>root</span> <span class='kw'>=</span> <span class='no'>path</span>)</div><div class='output co'>#&gt; <span class='message'>[ name       ]  example</span></div><div class='output co'>#&gt; <span class='message'>[ id         ]  20200302-113149-cbb2a584</span></div><div class='output co'>#&gt; <span class='message'>[ data       ]  source =&gt; dat: 20 x 2</span></div><div class='output co'>#&gt; <span class='message'>orderly has prepared your files at the path</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>  /tmp/Rtmp3R7mks/file3d3d3ab10a/draft/example/20200302-113149-cbb2a584</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>but unfortunately due to CRAN policies we cannot change the</span>
#&gt; <span class='message'>directory to that path.  In order to continue testing your</span>
#&gt; <span class='message'>report interactively, please run</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    setwd("/tmp/Rtmp3R7mks/file3d3d3ab10a/draft/example/20200302-113149-cbb2a584")</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>you will be responsible for getting back to your previous working</span>
#&gt; <span class='message'>directory after this, which you can do with</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    setwd("/orderly/docs/reference")</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Please see the documentation ?orderly::orderly_test_start for</span>
#&gt; <span class='message'>more details</span></div><div class='input'>
<span class='co'># The data in the orderly example is now available to use</span>
<span class='no'>dat</span></div><div class='output co'>#&gt;                            name     number
#&gt; 1              careful_bobolink 0.40683019
#&gt; 2            uncalorific_bonobo 0.91287592
#&gt; 3                marginal_eagle 0.29360337
#&gt; 4       unterrestrial_slothbear 0.45906573
#&gt; 5              illfated_anchovy 0.33239467
#&gt; 6                    wet_shrimp 0.65087047
#&gt; 7          classless_drafthorse 0.25801678
#&gt; 8            upstanding_tattler 0.47854525
#&gt; 9                 cranky_earwig 0.76631067
#&gt; 10 uninspirable_indianglassfish 0.08424691
#&gt; 11             changeable_bream 0.87532133
#&gt; 12        zealous_emperorshrimp 0.33907294
#&gt; 13            brilliant_nandine 0.83944035
#&gt; 14               waiting_agouti 0.34668349
#&gt; 15           tricolour_xrayfish 0.33377493
#&gt; 16  preagricultural_dromaeosaur 0.47635125
#&gt; 17          rhombohedral_canary 0.89219834
#&gt; 18            necessary_barnowl 0.86433947
#&gt; 19          ethnological_oyster 0.38998954
#&gt; 20       snobbish_capeghostfrog 0.77732070</div><div class='input'>
<span class='co'># Check to see which artefacts have been created so far:</span>
<span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/orderly/man/orderly_test_start.html'>orderly_test_check</a></span>(<span class='no'>p</span>)</div><div class='output co'>#&gt; <span class='message'>[ artefact   ]  mygraph.png: &lt;missing&gt;</span></div><div class='input'>
<span class='co'># Manually the code that this report has in its script</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/png.html'>png</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>p</span>, <span class='st'>"mygraph.png"</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span>(<span class='no'>dat</span>$<span class='no'>number</span>, <span class='no'>dat</span>$<span class='no'>name</span>), <span class='kw'>las</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span>()</div><div class='output co'>#&gt; pdf 
#&gt;   2 </div><div class='input'>
<span class='co'># We now confirm that the artefact has been created:</span>
<span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/orderly/man/orderly_test_start.html'>orderly_test_check</a></span>(<span class='no'>p</span>)</div><div class='output co'>#&gt; <span class='message'>[ artefact   ]  mygraph.png: 7a68f55b8b00697689c38f0d43d1f73c</span></div><div class='input'><span class='co'># The function orderly_data does all the preparation work that</span>
<span class='co'># orderly_run does, but does not run the report; instead it</span>
<span class='co'># returns the created environment with all the data and parameters</span>
<span class='co'># set.</span>
<span class='no'>path</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/orderly/man/orderly_example.html'>orderly_example</a></span>(<span class='st'>"demo"</span>)
<span class='no'>env</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/orderly/man/orderly_test_start.html'>orderly_data</a></span>(<span class='st'>"other"</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>nmin</span> <span class='kw'>=</span> <span class='fl'>0.2</span>), <span class='kw'>root</span> <span class='kw'>=</span> <span class='no'>path</span>)</div><div class='output co'>#&gt; <span class='message'>[ parameter  ]  nmin: 0.2</span></div><div class='output co'>#&gt; <span class='message'>[ data       ]  source =&gt; extract: 19 x 2</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span>(<span class='no'>env</span>)</div><div class='output co'>#&gt; [1] "extract" "nmin"   </div><div class='input'><span class='no'>env</span>$<span class='no'>nmin</span></div><div class='output co'>#&gt; [1] 0.2</div><div class='input'><span class='no'>env</span>$<span class='no'>extract</span></div><div class='output co'>#&gt;                           name    number
#&gt; 1             careful_bobolink 0.4068302
#&gt; 2           uncalorific_bonobo 0.9128759
#&gt; 3               marginal_eagle 0.2936034
#&gt; 4      unterrestrial_slothbear 0.4590657
#&gt; 5             illfated_anchovy 0.3323947
#&gt; 6                   wet_shrimp 0.6508705
#&gt; 7         classless_drafthorse 0.2580168
#&gt; 8           upstanding_tattler 0.4785452
#&gt; 9                cranky_earwig 0.7663107
#&gt; 10            changeable_bream 0.8753213
#&gt; 11       zealous_emperorshrimp 0.3390729
#&gt; 12           brilliant_nandine 0.8394404
#&gt; 13              waiting_agouti 0.3466835
#&gt; 14          tricolour_xrayfish 0.3337749
#&gt; 15 preagricultural_dromaeosaur 0.4763512
#&gt; 16         rhombohedral_canary 0.8921983
#&gt; 17           necessary_barnowl 0.8643395
#&gt; 18         ethnological_oyster 0.3899895
#&gt; 19      snobbish_capeghostfrog 0.7773207</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rich FitzJohn, Robert Ashton, Alex Hill, Martin Eden, Wes Hinsley, Emma Russell, James Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


