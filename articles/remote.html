<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>orderly remotes • orderly</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="orderly remotes">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">orderly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/orderly.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/changelog.html">orderly changelog</a>
    </li>
    <li>
      <a href="../articles/remote.html">orderly remotes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vimc/orderly">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>orderly remotes</h1>
                        <h4 class="author">Rich FitzJohn</h4>
            
            <h4 class="date">2020-03-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vimc/orderly/blob/master/vignettes/remote.Rmd"><code>vignettes/remote.Rmd</code></a></small>
      <div class="hidden name"><code>remote.Rmd</code></div>

    </div>

    
    
<p>Orderly supports a centralised workflow, where a central server holds the canonical version of a report. In order to make this workflow work, we need a number of things:</p>
<ul>
<li>To be able to run a report on a central server</li>
<li>To be able to get copies of reports from the central server in order to use them as dependencies of locally run reports</li>
<li>To be able to share these centrally run reports with someone</li>
</ul>
<p>To make this workflow work, we have developed some additional software.</p>
<p>First, we have a docker-based server system called <a href="https://github.com/vimc/orderly-web">OrderlyWeb</a> which can be deployed onto a server. We will communicate with this server over https using a package <a href="https://github.com/vimc/orderlyweb"><code>orderlyweb</code></a> which will follow <code>orderly</code> onto CRAN.</p>
<div id="orderlyweb" class="section level2">
<h2 class="hasAnchor">
<a href="#orderlyweb" class="anchor"></a>OrderlyWeb</h2>
<p>The OrderlyWeb server software provides a number of things</p>
<ol style="list-style-type: decimal">
<li>A persistent copy of R running <code>orderly</code> that can run reports as needed using the <code><a href="../reference/orderly_runner.html">orderly::orderly_runner</a></code> function</li>
<li>A web server that exposes a user-friendly web portal showing versions of orderly reports and an http api (this application is written in <a href="https://kotlinlang.org">Kotlin</a>)</li>
<li>A <a href="https://en.wikipedia.org/wiki/Reverse_proxy">reverse proxy</a> used to secure the application with https</li>
</ol>
<p>A <a href="https://raw.githubusercontent.com/vimc/montagu-machine/master/docs/diagrams/OrderlyWeb%20architecture.png">diagram may help show how the pieces fit together</a></p>
<p>Getting OrderlyWeb installed requires a little work, and you will need access to an appropriate server running docker, our <a href="https://github.com/vimc/orderly-web-deploy/">python-based deployment tool</a>, and TLS certificates for the server that you are using. We recommend using <a href="https://www.vaultproject.io">vault</a> for storing certificates and any secrets used in deployment.</p>
<p>OrderlyWeb will use GitHub for authentication, the setup for which <a href="https://github.com/vimc/orderly-web/blob/master/docs/auth.md#authenticating-with-github">is described here</a>.</p>
</div>
<div id="configuring-orderly-to-talk-to-orderlyweb" class="section level2">
<h2 class="hasAnchor">
<a href="#configuring-orderly-to-talk-to-orderlyweb" class="anchor"></a>Configuring <code>orderly</code> to talk to OrderlyWeb</h2>
<p>Once OrderlyWeb is running, we can tell <code>orderly</code> about it by adding an appropriate setting to the <code>orderly_config.yml</code> file. For example, if you had one testing and one production instance</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">remote</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="at">  </span><span class="fu">testing</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="at">    </span><span class="fu">driver</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span><span class="at"> orderlyweb::orderlyweb_remote</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="at">    </span><span class="fu">args</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="at">      </span><span class="fu">host</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span><span class="at"> testing.example.com</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="at">      </span><span class="fu">port</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span><span class="at"> </span><span class="dv">443</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="at">      </span><span class="fu">token</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span><span class="at"> $GITHUB_TOKEN</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="at">  </span><span class="fu">production</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="at">    </span><span class="fu">driver</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span><span class="at"> orderlyweb::orderlyweb_remote</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="at">    </span><span class="fu">args</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="at">      </span><span class="fu">host</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span><span class="at"> production.example.com</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="at">      </span><span class="fu">port</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span><span class="at"> </span><span class="dv">443</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="at">      </span><span class="fu">token</span><span class="kw"><a href="https://rdrr.io/r/base/Colon.html">:</a></span><span class="at"> $GITHUB_TOKEN</span></span></code></pre></div>
<p>where <code>$GITHUB_TOKEN</code> is an environment variable that holds a <a href="https://github.com/settings/tokens">GitHub token</a> with “user” scope. The <code>testing</code> remote is listed first, and so will be the default one used in any remote-using command.</p>
</div>
<div id="interacting-with-the-remote-server" class="section level2">
<h2 class="hasAnchor">
<a href="#interacting-with-the-remote-server" class="anchor"></a>Interacting with the remote server</h2>
<p>Several commands can interact with the remote server:</p>
<ul>
<li>
<code><a href="../reference/orderly_run_remote.html">orderly::orderly_run_remote</a></code> will run a report on a remote server, committing it immediately. This will save the log alongside the report.</li>
<li>
<code><a href="../reference/orderly_pull_dependencies.html">orderly::orderly_pull_archive</a></code> will pull a version of a report from a remote server</li>
<li>
<code><a href="../reference/orderly_pull_dependencies.html">orderly::orderly_pull_dependencies</a></code> will pull all the dependencies of a report from the remote server (i.e., versions of reports declared in the <code>depends:</code> section of a report)</li>
</ul>
</div>
<div id="future-developments" class="section level2">
<h2 class="hasAnchor">
<a href="#future-developments" class="anchor"></a>Future developments</h2>
<p>We hope that this system will become easier to deploy in future. We use it internally on two projects with orderly archives that hold gigabytes of analyses, and it has evolved to meet our needs. If you think it might work for you but can’t get started, please get in touch.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#orderlyweb">OrderlyWeb</a></li>
      <li><a href="#configuring-orderly-to-talk-to-orderlyweb">Configuring <code>orderly</code> to talk to OrderlyWeb</a></li>
      <li><a href="#interacting-with-the-remote-server">Interacting with the remote server</a></li>
      <li><a href="#future-developments">Future developments</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Rich FitzJohn, Robert Ashton, Alex Hill, Martin Eden, Wes Hinsley, Emma Russell, James Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
